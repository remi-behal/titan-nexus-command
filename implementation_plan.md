# Implementation Plan: Simultaneous Turn-Based Multiplayer Game

# Goal Description
Create a browser-based, simultaneous turn-based multiplayer game for 2-8 players. The game involves launching structures (Hubs, Weapons, etc.) from existing hubs to control territory and eliminate opponents.

## User Review Required
> [!NOTE]
> **Conflict Resolution Strategy (Future)**
> Since launches are simultaneous, two players might launch into the same spot.
> *Draft Plan*: First-come-first-served based on random seed? Or mutual destruction? For MVP, we will allow overlapping or just First-Index-Wins.

## Development Roadmap

### Phase 1: Single-Player Prototype (Weeks 1-2)
**Goal**: A working game in the browser with no server logic.
-   **Tech**: React + Vite (Client only).
-   **Focus**:
    -   **Game State Design**:
        -   **Map**: 2D Grid or Float Coordinates (Top-down). Contains Obstacles & Resource Nodes (Energy).
        -   **Entities**: `Hub` (Base), `Link` (Connection), `Weapon`, `Extractor`.
        -   **Resources**: `Energy` (Generated by Hubs + Extractors).
    -   **Mechanics**:
        -   **Launch**: Input Vector (Angle + Distance) from a source Hub.
        -   **Turn**: Accumulate Energy -> Select Actions -> Execute All Launches.
        -   **Win Condition**: Last player with at least one Hub.

### Phase 2: Local Multiplayer Setup (Week 3) (The "Hello World")
**Goal**: Two browser tabs talking to each other.
-   **Tech**: Node.js + Express + Socket.io (Server).
-   **Tasks**:
    -   Create `server/index.js` basic setup.
    -   `client` connects to `localhost:3000`.
    -   Migrate Game State from Client to Server.

### Phase 3: The Turn System (Week 4)
**Goal**: Implement the "Simultaneous Turn" logic.
-   **Logic**:
    -   Server maintains `currentTurn`.
    -   Clients send `SUBMIT_ORDER` (Launch command).
    -   **Timer**: Server runs a 30s countdown.
    -   **Resolution**: Process all launches. Update positions. Check collisions/destructions.

### Phase 4: Polish & Deployment (Week 5)
**Goal**: Hosting on OpenMediaVault (OMV).
-   **Infrastructure**: Docker + Nginx.

## Architecture & Tech Stack

### Local Dev
-   **Frontend**: React + Vite + Canvas API (for rendering connections/entities).
-   **Backend**: Node.js (Express) + Socket.io.

### Data Structures (Draft)

**GameState**
```javascript
{
  gameId: "uuid",
  turn: 1,
  map: { width: 1000, height: 1000, obstacles: [], nodes: [] }, // Static map data
  players: {
    "p1": { id: "p1", energy: 100, color: "#FF0000", status: "ALIVE" }
  },
  entities: {
    "e1": { id: "e1", type: "HUB", owner: "p1", x: 100, y: 100, hp: 10 }
  },
  links: [
    { from: "e1", to: "e2" } // Visual connectivity
  ]
}
```

**Action Schema**
```javascript
{
  type: "LAUNCH",
  sourceId: "e1",
  itemType: "WEAPON" | "HUB" | "EXTRACTOR",
  angle: 45, // degrees
  distance: 150
}
```

## Docker Configuration (Draft)
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install --production
COPY . .
EXPOSE 3000
CMD ["node", "server/index.js"]
```
